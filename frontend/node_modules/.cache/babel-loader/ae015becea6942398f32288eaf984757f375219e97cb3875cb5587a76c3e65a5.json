{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\METHILAN.R\\\\Downloads\\\\food donor\\\\frontend\\\\src\\\\context\\\\AppContext.jsx\",\n  _s = $RefreshSig$();\nimport { createContext, useEffect, useState, useRef } from \"react\";\nimport { createSearchParams, useNavigate } from \"react-router-dom\";\nimport { UserRole } from \"../constant/User\";\nimport DefaultLayout from \"../shared/layout/DefaultLayout\";\nimport Routes from \"../Routes\";\nimport { getAccessToken, removeAccessToken, storeAccessToken } from \"../utils/LocalDataStorage.Utils\";\nimport useHandleError from \"../hooks/useHandleError\";\nimport { setAuthHeader } from \"../api/AxiosInstance\";\nimport UserApi from \"../api/UserApi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const AppContext = /*#__PURE__*/createContext(null);\nconst AppProvider = () => {\n  _s();\n  const appNavigate = useNavigate();\n  const [userRole, setRole] = useState(UserRole.USER);\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(false);\n  const [authLoading, setAuthLoading] = useState(false);\n  const handleError = useHandleError();\n  const updateLoading = status => {\n    setLoading(status);\n  };\n  const navigate = to => {\n    const search = to.params ? `?${createSearchParams(Object.keys(to.params).map(key => [key, to.params[key]]))}` : undefined;\n    appNavigate({\n      pathname: to.name,\n      search: search\n    });\n  };\n  const logout = () => {\n    removeAccessToken();\n    setUser(null);\n    setRole(UserRole.USER);\n    navigate({\n      name: \"/login\"\n    });\n  };\n  const updateAuth = authResponse => {\n    if (authResponse.accessToken) {\n      storeAccessToken(authResponse.accessToken);\n      setAuthHeader(authResponse.accessToken);\n    }\n    if (authResponse.user) {\n      setUser(authResponse.user);\n      setRole(authResponse.user.role);\n      navigate({\n        name: `/${authResponse.user.role}-dashboard`\n      });\n    } else {\n      setUser(null);\n      setRole(UserRole.USER);\n      navigate({\n        name: '/'\n      });\n    }\n  };\n  const initializeAuth = async () => {\n    const accessToken = getAccessToken();\n    setAuthLoading(true);\n    try {\n      if (accessToken) {\n        setAuthHeader(accessToken);\n        const authResponse = await UserApi.getCurrentUserDetailAsync();\n        updateAuth(authResponse);\n      } else {\n        navigate({\n          name: '/'\n        });\n      }\n    } catch (error) {\n      console.log(error);\n      handleError(error, \"Please Login / SignUp\");\n      setUser(null);\n      setRole(UserRole.USER);\n      removeAccessToken();\n      navigate({\n        name: '/'\n      });\n    }\n    setAuthLoading(false);\n  };\n  useEffect(() => {\n    initializeAuth();\n  }, []);\n  const appLoading = loading || authLoading;\n  const appContextValue = {\n    userRole,\n    user,\n    appLoading,\n    updateLoading,\n    navigate,\n    updateAuth,\n    logout\n  };\n  return /*#__PURE__*/_jsxDEV(AppContext.Provider, {\n    value: appContextValue,\n    children: /*#__PURE__*/_jsxDEV(DefaultLayout, {\n      children: /*#__PURE__*/_jsxDEV(Routes, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 105,\n    columnNumber: 9\n  }, this);\n};\n_s(AppProvider, \"U41Sx8lGhPuTg3oT9dB3k3Xp4P4=\", false, function () {\n  return [useNavigate, useHandleError];\n});\n_c = AppProvider;\nexport default AppProvider;\nvar _c;\n$RefreshReg$(_c, \"AppProvider\");","map":{"version":3,"names":["createContext","useEffect","useState","useRef","createSearchParams","useNavigate","UserRole","DefaultLayout","Routes","getAccessToken","removeAccessToken","storeAccessToken","useHandleError","setAuthHeader","UserApi","jsxDEV","_jsxDEV","AppContext","AppProvider","_s","appNavigate","userRole","setRole","USER","user","setUser","loading","setLoading","authLoading","setAuthLoading","handleError","updateLoading","status","navigate","to","search","params","Object","keys","map","key","undefined","pathname","name","logout","updateAuth","authResponse","accessToken","role","initializeAuth","getCurrentUserDetailAsync","error","console","log","appLoading","appContextValue","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/METHILAN.R/Downloads/food donor/frontend/src/context/AppContext.jsx"],"sourcesContent":["import { createContext, useEffect, useState, useRef } from \"react\";\r\nimport { createSearchParams, useNavigate } from \"react-router-dom\";\r\nimport { UserRole } from \"../constant/User\";\r\nimport DefaultLayout from \"../shared/layout/DefaultLayout\";\r\nimport Routes from \"../Routes\";\r\nimport { getAccessToken, removeAccessToken, storeAccessToken } from \"../utils/LocalDataStorage.Utils\";\r\nimport useHandleError from \"../hooks/useHandleError\";\r\nimport { setAuthHeader } from \"../api/AxiosInstance\";\r\nimport UserApi from \"../api/UserApi\";\r\n\r\nexport const AppContext = createContext(null);\r\n\r\nconst AppProvider = () => {\r\n    const appNavigate = useNavigate();\r\n    const [userRole, setRole] = useState(UserRole.USER);\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [authLoading, setAuthLoading] = useState(false);\r\n    const handleError = useHandleError();\r\n\r\n    const updateLoading = (status) => {\r\n        setLoading(status);\r\n    }\r\n\r\n    const navigate = (to) => {\r\n        const search = to.params?`?${createSearchParams(Object.keys(to.params).map(key => ([key, to.params[key]])))}`:undefined\r\n        appNavigate({\r\n            pathname:to.name,\r\n            search:search\r\n        })\r\n    }\r\n\r\n    const logout = () => {\r\n        removeAccessToken();\r\n        setUser(null);\r\n        setRole(UserRole.USER);\r\n        navigate({\r\n            name:\"/login\"\r\n        })\r\n    }\r\n\r\n    const updateAuth = (authResponse) => {\r\n        if(authResponse.accessToken){\r\n            storeAccessToken(authResponse.accessToken);\r\n            setAuthHeader(authResponse.accessToken);\r\n        }\r\n        if(authResponse.user){\r\n            setUser(authResponse.user);\r\n            setRole(authResponse.user.role);\r\n            navigate({\r\n                name:`/${authResponse.user.role}-dashboard`\r\n            })\r\n        }else{\r\n            setUser(null);\r\n            setRole(UserRole.USER);\r\n            navigate({\r\n                name:'/'\r\n            })\r\n        }\r\n    }\r\n\r\n    const initializeAuth = async () => {\r\n        const accessToken = getAccessToken();\r\n        setAuthLoading(true);\r\n        try{\r\n            if(accessToken){\r\n                setAuthHeader(accessToken);\r\n                const authResponse = await UserApi.getCurrentUserDetailAsync();\r\n                updateAuth(authResponse);\r\n            }else{\r\n                navigate({\r\n                    name:'/'\r\n                })\r\n            }\r\n        }catch(error){\r\n            console.log(error);\r\n            handleError(error, \"Please Login / SignUp\");\r\n            setUser(null);\r\n            setRole(UserRole.USER);\r\n            removeAccessToken();\r\n            navigate({\r\n                name:'/'\r\n            })\r\n        }\r\n        setAuthLoading(false);\r\n    }\r\n\r\n    useEffect(()=>{\r\n        initializeAuth();\r\n    },[])\r\n\r\n    const appLoading = loading || authLoading;\r\n\r\n    const appContextValue = {\r\n        userRole,\r\n        user,\r\n        appLoading,\r\n        updateLoading,\r\n        navigate,\r\n        updateAuth,\r\n        logout\r\n    }\r\n\r\n    return (\r\n        <AppContext.Provider value={appContextValue}>\r\n            <DefaultLayout>\r\n                <Routes />\r\n            </DefaultLayout>\r\n        </AppContext.Provider>\r\n    )\r\n\r\n}\r\n\r\nexport default AppProvider;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}